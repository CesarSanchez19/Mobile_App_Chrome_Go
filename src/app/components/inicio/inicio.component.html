<!-- Video de fondo para usar getUserMedia -->
<video id="bg-video" autoplay muted playsinline></video>

<div class="main">
  <div class="inicio_content">
    <!-- Toolbar del inicio -->
    <div class="toolbar_container">
      <ion-segment value="buttons">
        <!-- Icono para abrir galería/archivos -->
        <ion-segment-button (click)="openGallery()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-images" viewBox="0 0 16 16">
            <path d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
            <path d="M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2M14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1M2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1z"/>
          </svg>
        </ion-segment-button>

        <!-- Icono para encender/apagar flash (no soportado en web) -->
        <ion-segment-button (click)="toggleFlash()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-lightning-charge-fill bi-images" viewBox="0 0 16 16">
            <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>
          </svg>
        </ion-segment-button>

        <!-- Icono para cambiar cámara -->
        <ion-segment-button (click)="switchCamera()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" fill="currentColor" class="bi bi-images">
            <path d="M7.809 50.348H48.19c4.875 0 7.36-2.438 7.36-7.266V18.543c0-4.828-2.485-7.242-7.36-7.242h-5.484c-1.828 0-2.39-.375-3.445-1.547l-1.899-2.11c-1.148-1.288-2.343-1.992-4.781-1.992h-9.328c-2.414 0-3.61.704-4.781 1.992l-1.899 2.11c-1.031 1.148-1.617 1.547-3.445 1.547h-5.32c-4.875 0-7.36 2.414-7.36 7.242v24.539c0 4.828 2.485 7.266 7.36 7.266m30.117-12.75l-4.406-5.813c-.61-.797-.211-1.828.726-1.828h3.164c0-5.719-3.914-9.703-9.422-9.703c-1.734 0-3.14.422-4.57 1.195c-1.594.774-2.812-.14-2.812-1.289c0-.562.257-1.195.937-1.617c1.5-.914 3.844-1.711 6.445-1.711c7.477 0 12.89 5.438 12.89 13.125h2.79c.96 0 1.313 1.008.703 1.828l-4.43 5.813c-.492.656-1.476.68-2.015 0m-9.938 4.992c-7.476 0-12.867-5.696-12.867-13.125h-2.789c-.984 0-1.312-1.031-.703-1.852l4.43-5.812c.492-.633 1.476-.68 1.992 0l4.43 5.812c.609.82.21 1.852-.75 1.852h-3.165c0 5.437 3.915 9.68 9.422 9.68c1.758 0 3.188-.422 4.57-1.172c1.641-.82 2.813.164 2.813 1.359c0 .563-.281 1.102-.937 1.547c-1.477.96-3.868 1.71-6.446 1.71"/>
          </svg>
        </ion-segment-button>
      </ion-segment>
    </div>

    <!-- Botón para tomar foto/escaneo -->
    <ion-fab>
      <ion-fab-button (click)="capturePhoto()">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-upc-scan" viewBox="0 0 16 16">
          <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5M.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5M3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0z"/>
        </svg>
      </ion-fab-button>
    </ion-fab>

    <!-- Input oculto para seleccionar imagen en web -->
    <input type="file" accept="image/*" id="fileInput" (change)="onFileSelected($event)">
  </div>
</div>

<!-- Modal para mostrar los colores extraídos -->
<ion-modal [isOpen]="showModal" (didDismiss)="closeModal()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Colores detectados</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeModal()">Cerrar</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <ion-list>
        <ion-item *ngFor="let color of colors">
          <ion-label>
            <h2>{{ color.name }}</h2>
            <p>{{ color.hex }}</p>
          </ion-label>
          <!-- Tarjeta que muestra el color -->
          <ion-card style="width: 50px; height: 50px; margin-left: auto" [style.background]="color.hex"></ion-card>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>
